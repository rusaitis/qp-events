#!/usr/bin/env python3
import numpy as np
from wavesolver.model import *
# ----------------------------------------------------------------------------
#
# This file contains the simulation configurations. Field lines can be
# specified by their starting trace position, and the density models and
# field models can be changed.
#
# ----------------------------------------------------------------------------

# ----------------------------------------------------------------------------
#
#                                  Field lines
#
# ----------------------------------------------------------------------------

def fieldlineConfigurations(configuration=0,
                            NFieldLines=1,
                            L=None,
                            th=None,
                            phi=[0],
                            component='toroidal'):
    if L is not None:
        if NFieldLines > 2 and size(L) > 1:
            Lvalues = [R for R in np.linspace(L[0], L[-1], NFieldLines) if
                       (abs(R) > 3)]
            return [{"R": R, "component": component} for R in
                    Lvalues]
        else:
            fieldlinelist = []
            for R in L:
                fieldlinelist.append({"R": R, "component": component})
            return fieldlinelist
    elif th is not None:
        fieldlinelist = []
        if phi is None:
            phi = [0.]
        for _phi in phi:
            if NFieldLines > 2 and size(th) > 1:
                thlist = [{"TH": theta,
                           "PHI": _phi,
                           "component": component} for theta in
                          np.linspace(th[0], th[-1], NFieldLines)]
                fieldlinelist.extend(thlist)
            else:
                for theta in th:
                    fieldlinelist.append({"TH": theta,
                                          "PHI": _phi,
                                          "component": component})
        return fieldlinelist
    else:
        if phi is None:
            phi = 0.
        if configuration == 0:
            return [{"TH": theta,
                     "PHI": phi,
                     "component": component} for theta in
                    np.linspace(22., 30., 1)]
        if configuration == 1:
            fls_day = [{"R": r,
                        "PHI": 0.,
                        "component": component} for r in
                       np.linspace(3, 24.5, NFieldLines)]
            fls_night = [{"R": r, "PHI": 180., "component": component} for r in
                         np.linspace(3, 24.5, NFieldLines)]
            fls_day.extend(fls_night)
            return fls_day
        if configuration == 2:
            return [{"R": 19, "component": component}]

    # "fieldlines": [{"R": R, "component": "toroidal"} for R in
                     # np.linspace(19.4, 24.82, 1)]
    # "fieldlines": [{"R": R, "component": "toroidal"} for R in
                     # np.linspace(6, 19.5, 4)]
    # "fieldlines": [{"TH": th, "component": "toroidal"} for th in
                     # np.linspace(14.2, 23., 1)] #75.8 map to 20RS for KMAG
    # "fieldlines": [{"TH": th, "component": "toroidal"} for th in
                     # np.linspace(13, 30., 1)] #75.8 #77 degrees for dipole
    # "fieldlines": fls_day
# ----------------------------------------------------------------------------
#
#                            PDE Solver parameters.
#
# ----------------------------------------------------------------------------

# Basic computational parameters
configBasicSolve = {"fun": fde,
                    "BC": [0.0, 0.0],
                    "dydz": [1.0, 0.5],
                    "wRes": 100,
                    "res": 100,
                    "modes": 3,
                    "tol": 1E-5,
                    "method": 'LSODA'}  # 'RK45','BDF','LSODA'

# ----------------------------------------------------------------------------
#
#                   Nominal Saturn Simulation configuration
#
# ----------------------------------------------------------------------------

configSaturnNominal = {
    "base": {
        "planet": "saturn",
        "densityModelName": "bagenal",  # "bagenal" | "yates" | "persoon"
        "BFieldModelName": "KMAG",  # "KMAG" | "dipole"
        # "BFieldModel": KMAGField,
        # "BFieldModel": dipField,
        "L": 10.0,
        "traceFrom": "equator",  # "equator" | "latitude"
        # "component": "poloidal",
        "wlim": [0, 0.005],  # [0., 0.1]
        "res": 100,
        "name": "kmag",
        "TH": 90.,
        "PHI": 0.,
        "step": 0.01
        # "zmax": 20.
    },
    "fieldlines": []
}

# ----------------------------------------------------------------------------
#
#                   Nominal Earth Simulation configuration
#
# ----------------------------------------------------------------------------

configEarthNominal = {
    "base": {
        "planet": "earth",
        "densityModelName": "cummings",  # "bagenal" | "yates" | "persoon"
        "BFieldModelName": "dipole",  # "KMAG" | "dipole"
        "L": 7.0,
        "traceFrom": "latitude",  # "equator" | "latitude"
        # "component": "poloidal",
        "wlim": [0, 0.005],  # [0., 0.1]
        "res": 100,
        "name": "dip",
        "TH": 90.,
        "PHI": 0.,
        "step": 0.01
        # "zmax": 20.
    },
    "fieldlines": []
}
# ----------------------------------------------------------------------------
#                           _  ____  __    _    ____
#                          | |/ /  \/  |  / \  / ___|
#                          | ' /| |\/| | / _ \| |  _
#                          | . \| |  | |/ ___ \ |_| |
#                          |_|\_\_|  |_/_/   \_\____|
#
# Nominal configuration for KMAG (Saturn's magnetic field model).
#
# ----------------------------------------------------------------------------

# Standard configuration for Saturn's KMAG Model
KMAGConfigStandard = {"ETIME": 1483228800,  # (01 Jan 2017)
                      "EPOCH": 'j2000',     # ('j2000' | 'ctime')
                      "BY_IMF": -0.2,
                      "BZ_IMF": 0.1,
                      "Dp": 0.017,
                      "IN_COORD": 'DIS',    # S3C/DIS/DIP/KSM/KSO
                      "OUT_COORD": 'DIS',   # S3C/DIS/DIP/KSM/KSO
                      "IN_CARSPH": 'CAR',   # INPUT IN SPH/CAR
                      "OUT_CARSPH": 'CAR',  # OUTPUT IN SPH/CAR
                      "TRACE": 'Y',
                      "step": 0.01,
                      "maxIter": 1E4,
                      "FLATTENING": 0.09796, # f = (a-c) / a,
                      "maxR": 100,
                      "method": 'RK4'
                     }

# ----------------------------------------------------------------------------
#                       ____        _
#                      / ___|  __ _| |_ _   _ _ __ _ __
#                      \___ \ / _` | __| | | | '__| '_ \
#                       ___) | (_| | |_| |_| | |  | | | |
#                      |____/ \__,_|\__|\__,_|_|  |_| |_|
#
# Saturn configuration with KMAG magnetic field and realistic density model
#
# ----------------------------------------------------------------------------

Saturn = {"units": RS,
          "wlim": [0, 0.001],  # Initial eigenfrequency guess range
          "densityModel": densityModels,  # Density Function
          # "BFieldModel": dipField,  # Magnetic Field Function
          "BFieldModel": KMAGField,  # Magnetic Field Function
          "densityModelName": 'bagenal',
          "BFieldModelName": 'KMAG',
          "dipM": dipM_Saturn,  # Dipole Moment
          "m": 18 * amu,  # Plasma Mass
          "coords": 'ds'}  # 'cos' | 'carterian' | 'ds'

# ----------------------------------------------------------------------------
#
#                                   BATCHES
#
# Baches are used for running similar configurations with a change in a
# single parameter
#
# ----------------------------------------------------------------------------
batchNominal = [{"Dp": 0.017}]
# batchTH = [{"PHI": 0., "TH": th} for th in np.linspace(14.5, 30., 100)]
# batchTH = [{"PHI": 0., "TH": th} for th in np.linspace(15.5, 27., 2)]
# batchTH = [{"PHI": 0., "TH": th} for th in np.linspace(20.5, 30., 3)]
# batchz0 = [{"PHI": 0., "TH": 17.5, "z0": z0} for z0 in
             # np.linspace(30, 90., 3)]
# batchz0 = [{"PHI": 0., "TH": 25.5, "z0": z0} for z0 in
             # np.linspace(30, 90., 3)]
# batchPHI = [{"PHI": phi} for phi in np.linspace(0., 180., 2)]
# batchDp = [{"Dp": Dp} for Dp in np.linspace(0.017, 0.017 * 2, 20)]
# batchBY_IMF = [{"BY_IMF": BY_IMF} for BY_IMF in np.linspace(-0.2, 0.2, 2)]
# batchBZ_IMF = [{"BZ_IMF": BZ_IMF} for BZ_IMF in np.linspace(0.1, -0.1, 2)]
# batchDATA_SEC = [{"ETIME": DATA_SEC} for DATA_SEC
#                  in np.linspace(1483228800, 1483228800
#                                             + 29 * 12 * 30 * 86400, 40)]
# batchAll = [{"PHI": 0., "component": "toroidal", "name": "ToroidalDay"},
#             {"PHI": 180., "component": "toroidal", "name": "ToroidalNight"},
#             {"PHI": 0., "component": "poloidal", "name": "PoloidalDay"},
#             {"PHI": 180., "component": "poloidal", "name": "PoloidalNight"}]
# batchAll = [{"PHI": 90., "component": "toroidal", "name": "ToroidalDusk"},
#             {"PHI": 270., "component": "toroidal", "name": "ToroidalDawn"},
#             {"PHI": 90., "component": "poloidal", "name": "PoloidalDusk"},
#             {"PHI": 270., "component": "poloidal", "name": "PoloidalDawn"}]
# batchDensity = [{"scalingFactor": sf} for sf in np.linspace(1E-1, 1E4, 3)]


# ----------------------------------------------------------------------------
#
#                       Faster PDE Solver parameters.
#
# ----------------------------------------------------------------------------

# Basic computational parameters
configFastSolve = {"step": 0.02,
                   "wRes": 200,
                   "res": 200,
                   "tol": 1E-2 / 2}

# ----------------------------------------------------------------------------
#                        _____           _   _
#                       | ____|__ _ _ __| |_| |__
#                       |  _| / _` | '__| __| '_ \
#                       | |__| (_| | |  | |_| | | |
#                       |_____\__,_|_|   \__|_| |_|
#
# Earth configuration with a dipole magnetic field and a radial density model
#
# ----------------------------------------------------------------------------

Earth = {"units": RE,
         "wlim": [0, 1.],
         "densityModel": densityModels,  # Density Function
        #  "BFieldModel": dipField,  # Magnetic Field Function
         "BFieldModel": TsyganenkoField,  # Magnetic Field Function
         "densityModelName": 'cummings',
         "BFieldModelName": 'dipole',
        #  "BFieldModelName": 't89',
         "dipM": dipM_Earth,   # Dipole Moment
         "mIndex": 1,  # Parameters for the Cummings et al. density model
         "m": m0_Cummings,  # Plasma Mass
         "coords": 'ds'}  # 'cos' | 'carterian' | 'ds'

# ----------------------------------------------------------------------------
#
#                         MAGNETOSPHERIC BOX MODEL
#
# 2D Box configuration a with uniform magnetic field and a two-density plasma
# profile according to Yates el al. (2016) parameters.
#
# ----------------------------------------------------------------------------
Box = {"units": RS,
       "wlim": [0., 0.02],
       "densityModel": densityModels,  # Density Function
       "BFieldModel": uniformField,  # Magnetic Field Function
       "densityModelName": 'yates',
       "BFieldModelName": 'uniform',
       "dipM": 2E-9,  # Dipole Moment
       "m": m0_Persoon,  # Plasma Mass
       "coords": 'cartesian'}  # 'cos' | 'carterian' | 'ds'

# ----------------------------------------------------------------------------
#
#               A MORE REALISTIC MAGNETOSPHERIC BOX MODEL
#
# 2D Box configuration a with uniform magnetic field in z, but more realistic
# field and plasma density variation with equatorial crossing distance.
#
# ----------------------------------------------------------------------------

SaturnUniform = {"units": RS,
                 "wlim": [0, 0.001],
                 "densityModel": densityModels,  # Density Function
                 "BFieldModel": uniformField,  # Magnetic Field Function
                 "densityModelName": 'yates',
                 "BFieldModelName": 'dipole',
                 "dipM": dipM_Saturn,
                 "m": m0_Persoon,
                 "coords": 'ds'}  # 'cos' | 'carterian' | 'ds'

# ----------------------------------------------------------------------------
#
#       Comparison of Cummings et al. (1969) and Singer et al. (1981)
#
# ----------------------------------------------------------------------------
# configCummingsSingerComparison = {
#     "base": {
#         "planet": "earth",
#         "densityModelName": "cummings",
#         "BFieldModelName": "dipole",
#         "L": 6.6,
#         "traceFrom": "equator",
#         "coords": "cos",
#         "component": "toroidal",
#         "wlim": [0, 1.]
#     },
#     "fieldlines": [
#         {"m": 0, "coords": "cos", "component": "toroidal"},
#         {"m": 0, "coords": "cos", "component": "poloidal"},
#         {"m": 0, "coords": "ds", "component": "toroidal"},
#         {"m": 0, "coords": "ds", "component": "poloidal"},
#         {"m": 1, "coords": "cos", "component": "toroidal"},
#         {"m": 1, "coords": "cos", "component": "poloidal"},
#         {"m": 1, "coords": "ds", "component": "toroidal"},
#         {"m": 1, "coords": "ds", "component": "poloidal"},
#         {"m": 2, "coords": "cos", "component": "toroidal"},
#         {"m": 2, "coords": "cos", "component": "poloidal"},
#         {"m": 2, "coords": "ds", "component": "toroidal"},
#         {"m": 2, "coords": "ds", "component": "poloidal"},
#         {"m": 3, "coords": "cos", "component": "toroidal"},
#         {"m": 3, "coords": "cos", "component": "poloidal"},
#         {"m": 3, "coords": "ds", "component": "toroidal"},
#         {"m": 3, "coords": "ds", "component": "poloidal"},
#         {"m": 4, "coords": "cos", "component": "toroidal"},
#         {"m": 4, "coords": "cos", "component": "poloidal"},
#         {"m": 4, "coords": "ds", "component": "toroidal"},
#         {"m": 4, "coords": "ds", "component": "poloidal"},
#         {"m": 5, "coords": "cos", "component": "toroidal"},
#         {"m": 5, "coords": "cos", "component": "poloidal"},
#         {"m": 5, "coords": "ds", "component": "toroidal"},
#         {"m": 5, "coords": "ds", "component": "poloidal"}
#     ]
# }

# ----------------------------------------------------------------------------
#
# For solving Cummings et al. (1969) configuration with Singer et al (1981)
# PDE's.
#
# ----------------------------------------------------------------------------
# configCummingsInSingerPDES = {
#     "base": {
#         "planet": "earth",
#         "densityModelName": "cummings",
#         # "densityModelName": "yates",
#         "BFieldModelName": "dipole",
#         "L": 6.6,
#         "traceFrom": "equator",
#         "coords": "cos",
#         "component": "toroidal",
#         "wlim": [0, 0.1],
#         "mIndex": 3
#     },
#     "fieldlines": [
#         {"L": 6., "component": "toroidal"},
#     ]
# }

# ----------------------------------------------------------------------------
# A comparison between KMAG and dipole magnetic field lines.
# ----------------------------------------------------------------------------
# fieldlinesKMAGvDIP = [{"BFieldModelName": "KMAG", "TH": 30, "PHI": 0.,
#                        "R": 1., "component": "toroidal", "name": "KMAG1"},
#                       {"BFieldModelName": "KMAG", "TH": 20, "PHI": 0.,
#                        "R": 1., "component": "toroidal", "name": "KMAG2"},
#                       {"BFieldModelName": "KMAG", "TH": 16, "PHI": 0.,
#                        "R": 1., "component": "toroidal", "name": "KMAG2"},
#                       {"BFieldModelName": "KMAG", "TH": 10, "PHI": 0.,
#                        "R": 1., "component": "toroidal", "name": "KMAG2"},
#                       {"BFieldModelName": "KMAG", "TH": 30, "PHI": 180.,
#                        "R": 1., "component": "toroidal", "name": "KMAG3"},
#                       {"BFieldModelName": "KMAG", "TH": 20, "PHI": 180.,
#                        "R": 1., "component": "toroidal", "name": "KMAG3"},
#                       {"BFieldModelName": "KMAG", "TH": 16, "PHI": 180.,
#                        "R": 1., "component": "toroidal", "name": "KMAG4"},
#                       {"BFieldModelName": "KMAG", "TH": 10, "PHI": 180.,
#                        "R": 1., "component": "toroidal", "name": "KMAG5"},
#                       {"BFieldModelName": "dipole", "TH": 30, "PHI": 0.,
#                        "R": 1., "component": "toroidal", "name": "dipole1"},
#                       {"BFieldModelName": "dipole", "TH": 20, "PHI": 0.,
#                        "R": 1., "component": "toroidal", "name": "dipole1"},
#                       {"BFieldModelName": "dipole", "TH": 16, "PHI": 0.,
#                        "R": 1., "component": "toroidal", "name": "dipole2"},
#                       {"BFieldModelName": "dipole", "TH": 10, "PHI": 0.,
#                        "R": 1., "component": "toroidal", "name": "dipole2"},
#                       {"BFieldModelName": "dipole", "TH": 30, "PHI": 180.,
#                        "R": 1., "component": "toroidal", "name": "dipole3"},
#                       {"BFieldModelName": "dipole", "TH": 20, "PHI": 180.,
#                        "R": 1., "component": "toroidal", "name": "dipole3"},
#                       {"BFieldModelName": "dipole", "TH": 16, "PHI": 180.,
#                        "R": 1., "component": "toroidal", "name": "dipole4"},
#                       {"BFieldModelName": "dipole", "TH": 10, "PHI": 180.,
#                        "R": 1., "component": "toroidal", "name": "dipole5"}]

# ----------------------------------------------------------------------------
# A simplified Saturn's magnetosphere (uniform field)
# ----------------------------------------------------------------------------
# configSaturnUniformField = {
#     "base": {
#         "planet": "saturn_uniform",
#         "densityModelName": "bagenal",
#         "BFieldModelName": "uniform",
#         "L": 10.0,
#         # "traceFrom":  "latitude",
#         "traceFrom": "equator",
#         "coords": "ds",
#         # "component": "poloidal",
#         "wlim": [0, 0.01],
#         # "wlim": [0, 0.001],
#         # "wlim": [0, 1],
#         "res": 100,
#         "name": "uniform",
#         "TH": 90.,
#         "PHI": 0.,
#         "zmax": 15.
#     },
#     "fieldlines": [{"R": R, "component": "toroidal"} for R in
#                    np.linspace(4, 20, 2)]
# }


# ----------------------------------------------------------------------------
# Previously computed results (eigenfrequencies, L, and invariant latitude)
# ----------------------------------------------------------------------------
# class wData:
#     def __init__(self, w=None, L=None, th=None):
#         self.w = w
#         self.L = L
#         self.th = th

# # POLOIDAL
# # phi=0,
# # th=15-30
# # (can go 14.5-30)
# wData_poloidal_day = wData()
# wData_poloidal_day.L = [19.19336262878394, 18.44170762158429, 17.634689818650056, 16.774619280329436, 15.870973568121144, 14.945173033457994, 14.028904768370195, 13.155158873993123, 12.344938112441067, 11.604749975764234, 10.930738904575481, 10.316211756260143, 9.75388671248544, 9.238445540241065, 8.766606812216457, 8.335885915726054, 7.943934100935128, 7.588164336649544, 7.2651598055376585, 6.971815904052544, 6.704223892442735, 6.459211561792972, 6.233782238737572, 6.025535743815648, 5.832214930881749, 5.651921266259819, 5.483164870765788, 5.32477802354239, 5.1753917726100696, 5.034291310601722, 4.90086400545863, 4.774111330918037, 4.653541769448298, 4.538740904700333, 4.429129146909131, 4.3245506124914295, 4.224256029172474, 4.128576752344565, 4.036678461309496, 3.9484409581504445, 3.8638078368366093, 3.782269953348121, 3.7039985151184927, 3.6286372097524437, 3.5559922665832673, 3.4859882386491208, 3.4183656913794347, 3.353103040468634, 3.290203945046568, 3.2295761331790898]
# wData_poloidal_day.th = [75.62861565331889, 75.27986862301968, 74.97214410492452, 74.67925042127948, 74.31561288493302, 74.02297955170876, 73.71445642892299, 73.42205149985959, 73.11320887605595, 72.76612091185962, 72.45709641037331, 72.14782349646342, 71.85625974709927, 71.5468447018366, 71.18272085903013, 70.8730188357892, 70.58231017356529, 70.27261064849246, 69.96278983080701, 69.65286577708889, 69.34285658011552, 68.97902216688026, 68.66900619790142, 68.3589626816401, 68.04890977314076, 67.73886563074794, 67.4288484097261, 67.11887625588233, 66.80896729919718, 66.49913964746965, 66.1894113799813, 65.85626987841381, 65.54651656849668, 65.23691831541119, 64.92749306737964, 64.59358191100713, 64.28428495429985, 63.97521631667995, 63.64086268756404, 63.38347014898159, 63.04869099239295, 62.7400206160962, 62.40502328213168, 62.096746325290766, 61.761615448451096, 61.45380926895663, 61.16903168760962, 60.86158935974518, 60.52628863270445, 60.19088579329347]
# wData_poloidal_day.w = [[0.033558742345075956, 0.0282208957321774, 0.02772467075603359, 0.026864985312097356, 0.02661643310216696, 0.024708090894123895, 0.02330690152826437, 0.024306113776457795, 0.02300044861691556, 0.022307101939093965, 0.021745217844128632, 0.021810430643877485, 0.0223661026663933, 0.02382493352234556, 0.026161371712373295, 0.027815679716468717, 0.03085994648944793, 0.0318753133422303, 0.033636944903576514, 0.03528201734838991, 0.04053584574555922, 0.04617845642962327, 0.05272685834323956, 0.05969520171251207, 0.06677140449646035, 0.07547937384034323, 0.08437070397465032, 0.09329142272735941, 0.10455052566429042, 0.11729743264719455, 0.13063211392245613, 0.14740515400622103, 0.16634231158569548, 0.1883890175698259, 0.21577832904483915, 0.24718548897472326, 0.2774031246737037, 0.3102479678468499, 0.3471810196751399, 0.3836657982339227, 0.4164833791174422, 0.45553772059371306, 0.5175037232092775, 0.6096437906447949, 0.7371493338033753, 0.9171029470740109, 1.0947921515984556, 1.2632318449102526, 1.4588789103804924, 1.6773795252967278], [0.13703233491040082, 0.13980523428430194, 0.146987281353913, 0.15694313824026604, 0.1704566173555516, 0.1683698747001532, 0.16522605713541824, 0.17451795515947152, 0.1643633551039853, 0.15784443931099965, 0.15128446638667564, 0.14894647672075972, 0.1505041643955478, 0.15766800213492185, 0.16977597896744062, 0.17711333726653242, 0.19232219550185217, 0.1939462152266933, 0.20192470967717713, 0.20679445742753616, 0.23594518316584798, 0.26764282981978477, 0.30825087734057144, 0.3481827883432068, 0.3915914010191287, 0.4429409725082536, 0.49855562419055616, 0.556679259974059, 0.6296561620416894, 0.7127734791559918, 0.7980503342348274, 0.9044565741973265, 1.0369308000955406, 1.1935199953456863, 1.402069991689627, 1.6574659338053335, 1.8907867669963336, 2.141775513680088, 2.4367767557446176, 2.7113672578457555, 2.9036250519571976, 3.1101428907001845, 3.577348870040765, 4.225416234442296, 5.160042757220513, 6.28541579754335, 7.51732985096196, 8.694945475965365, 9.94885737085971, 11.481731930479052], [0.21056286703319144, 0.2105676405294509, 0.21932893070869375, 0.2329533074177793, 0.25460008198494666, 0.25427031196370553, 0.25333480676891046, 0.2725135793755487, 0.26066449431429983, 0.25353626436584137, 0.24491160923423533, 0.24319992117377903, 0.24728354206692807, 0.26004791669121946, 0.28113085926555453, 0.29427649555741936, 0.3209706348459812, 0.3254330528034958, 0.34035836640678796, 0.3505820200950257, 0.4018094057682255, 0.4585280866452753, 0.5307479185426787, 0.6020170568900574, 0.6782319881854042, 0.7693574769639088, 0.8673512293971046, 0.9707994766226741, 1.100097762245219, 1.2463420103150697, 1.3964175784423003, 1.5848433342297306, 1.8182369330142625, 2.0974635046509107, 2.4658003794619727, 2.919370147734508, 3.3326551234248556, 3.7801542088636113, 4.298949763109778, 4.785580332769961, 5.126542389219217, 5.485738989324139, 6.311741687436207, 7.459821785275111, 9.107532603344941, 11.096199247459413, 13.284471299759774, 15.353768689336304, 17.592412974962986, 20.25683243460715], [0.30769700591564414, 0.3044219109926037, 0.31262911389336306, 0.3267804861470013, 0.3526027652010988, 0.3500798309266588, 0.34839288584495987, 0.37547027867955934, 0.35989115661514426, 0.3511670921039745, 0.3401737644844564, 0.33835731374836936, 0.34478563429576764, 0.3631289862774923, 0.3927608440381432, 0.411080780534773, 0.4491615673355101, 0.45610681684620447, 0.47751854502884483, 0.4930206765045871, 0.5656298863202887, 0.6460527774081601, 0.749731334563567, 0.8512762312824431, 0.9606454090808942, 1.0904834885095207, 1.2303667653146668, 1.3779733710299173, 1.5630771535769943, 1.7720361448098867, 1.9863742084414724, 2.253337198087038, 2.5885188684756857, 2.9835231981470622, 3.512605689521566, 4.159940661656461, 4.751412625838515, 5.390305356259695, 6.13392854897369, 6.829102960847109, 7.311021776667146, 7.822485236541889, 9.001720321746811, 10.670965885787036, 12.98974620427172, 15.828784146136035, 18.94397951124476, 21.887081307785245, 25.089638747566564, 28.900552247943793]]

# # POLOIDAL
# # phi=180,
# # th=16.5, 30, 50
# wData_poloidal_night = wData()
# wData_poloidal_night.L = [16.448738614252463, 14.862808415639353, 13.587029145475476, 12.563425209710925, 11.720225125824163, 11.003512802737133, 10.378547152660627, 9.823285499261436, 9.324384430084379, 8.873201564260782, 8.46390300038936, 8.092511229525726, 7.7552702080585165, 7.448758554282721, 7.169416921898182, 6.913537517074743, 6.678608313114342, 6.462403036023055, 6.262116575088649, 6.075297605879073, 5.901172341153917, 5.738029017005752, 5.584116850496593, 5.439083102876808, 5.302034420861487, 5.171314533075706, 5.048072602488993, 4.930110850680743, 4.817325606599579, 4.710066453883639, 4.6070626216712105, 4.5082051861023364, 4.413318366037058, 4.322301007565299, 4.234578727571375, 4.150463227159109, 4.069345279034454, 3.9911810282170865, 3.9154753223587044, 3.84251662325617, 3.7721915380849893, 3.7036806017798023, 3.638188147965962, 3.5743497310699746, 3.512547223881837, 3.4526119098444874, 3.3946416600283453, 3.3385392015071504, 3.283879565392129, 3.2312234525021633]
# wData_poloidal_night.th= [73.60396354586685, 73.35041025676429, 73.05811868918104, 72.82109676227218, 72.51200262385146, 72.27506738869351, 71.96571443287014, 71.72890901304436, 71.41935338683152, 71.18272085903013, 70.8730188357892, 70.63660218281728, 70.32681010089647, 70.09065216484363, 69.78082636612527, 69.52484288599034, 69.23516657035916, 68.97902216688026, 68.66900619790142, 68.43367072180959, 68.12379188836927, 67.86721936418508, 67.6104686031545, 67.30040999277375, 67.06586129206198, 66.80896729919718, 66.49913964746965, 66.2420753181978, 65.93232766258, 65.67514328433748, 65.41786855558055, 65.10828219739292, 64.85096062720682, 64.59358191100713, 64.33615642009569, 64.02693266655993, 63.769556489515985, 63.512166807859984, 63.2034000091153, 62.94613274808687, 62.68888519646741, 62.40502328213168, 62.14761988139697, 61.839521977543065, 61.58236194098292, 61.29765398908553, 61.04043223212092, 60.78330701464287, 60.52628863270445, 60.19088579329347]
# wData_poloidal_night.w = [[0.013184552079970524, 0.01455526916384353, 0.0159807606724889, 0.017711623907028212, 0.018733914461755517, 0.018564026090654575, 0.019293103928617897, 0.02031748034081433, 0.021709224438355813, 0.024156966435285594, 0.025368018056912748, 0.028628763853153483, -0.11017205647174858, 0.03163989010657427, 0.03307977060812881, 0.034775687362324975, 0.04056459098826751, 0.045399871135546, 0.051414412121496646, 0.05727540003920994, 0.06349928360982475, 0.07043968206744163, 0.07784608683655858, 0.08601521169748348, 0.09424398347793692, 0.10453749142435836, 0.11558200534512118, 0.1269689337787336, 0.1403896855632048, 0.15616784167974626, 0.1747430098608186, 0.19423912795496903, 0.2197063327617708, 0.24696379677861552, 0.29440315389596916, 0.30238759825599154, 0.33322821899742167, 0.3662552722404941, 0.3960496038589852, 0.42548550804816077, 0.45921098958988976, 0.5188313116526584, 0.594745002835585, 0.6980110539192226, 0.8338751847452691, 1.006123751199498, 1.146107004100497, 1.3102468068273194, 1.4927165512872975, 1.673829832276541], [0.14488906687016764, 0.15119469942563052, 0.1517631088552099, 0.155208428818767, 0.1535338069480237, 0.1445308365715902, 0.1437237549394717, 0.14613307181194546, 0.1522722896728525, 0.1647692108225671, 0.16910162738051793, 0.1843367102029683, 0.1886439330653747, 0.19549560032190016, 0.20071320309923202, 0.20707427908521658, 0.23770404965042496, 0.2651880480514418, 0.3011258659458929, 0.3368743316854353, 0.372313496094171, 0.41509977807190523, 0.461456413932275, 0.5108782210909112, 0.5640226097634685, 0.6294605077061386, 0.7019698885906122, 0.7737630996113141, 0.86327935784583, 0.9675172485407604, 1.0934607697446954, 1.242120212901188, 1.4342157152378978, 1.659259357110771, 1.8622436638257207, 2.0761308545590524, 2.322530619066915, 2.5967380655690815, 2.7823215738025353, 2.9528104925085463, 3.153747369461574, 3.5751417348452503, 4.116343616864072, 4.875961184554368, 5.808543372510444, 6.98032973778645, 7.916031100006538, 8.948780139579648, 10.104598950030924, 11.430035443979524], [0.19866694165561266, 0.21538553306122993, 0.22604317864918694, 0.23743615354004483, 0.2406558518449418, 0.23013126260934239, 0.23138616001254242, 0.2372881950219413, 0.24893346475337538, 0.2709024071439548, 0.2795143731152193, 0.30603004894945823, 0.3149526777993939, 0.32810993786606124, 0.33896506350373246, 0.35082722641962033, 0.4046580915125423, 0.4537412946701576, 0.517982094352569, 0.5813322203040913, 0.6438702336491979, 0.7206096546438455, 0.8021536608337347, 0.8897034973424945, 0.9843774652903892, 1.100566671990234, 1.2283479152319379, 1.3547331722028266, 1.5123191263863793, 1.6962419783879006, 1.9195576121476006, 2.1819649189481303, 2.5834732067696415, 2.9204667739901535, 3.2833747708379852, 3.664973065332694, 4.09834965373505, 4.586497958030857, 4.910309658934097, 5.210112511659685, 5.563042074697305, 6.308879430603471, 7.273683198766354, 8.613202375314371, 10.25821254700188, 12.322009440838082, 13.972271977123032, 15.799353508937815, 17.838573936816278, 20.170289555466884], [0.27387366951001013, 0.29546878544066923, 0.31010842512719167, 0.3265719708358655, 0.33250009624246146, 0.31864499427844967, 0.3214577760132922, 0.3300832760741359, 0.3466985682429266, 0.37796053235498267, 0.390074027515124, 0.4272126720510852, 0.44057569001277347, 0.4611481546101685, 0.47536293229840954, 0.49321018879469636, 0.5697219637068468, 0.6390480229689706, 0.7311594790037941, 0.8224450953770459, 0.9113044089211886, 1.0205808748685947, 1.1373462310341875, 1.262310696545275, 1.3976041773489718, 1.562379290274375, 1.7467935178513863, 1.9258620684495313, 2.151119892327093, 2.412778362566265, 2.7326358535800326, 3.1064754398360725, 3.5934982126621047, 4.168259811439921, 4.679965528407149, 5.223107022565313, 5.839701445329406, 6.544247482086894, 7.003358616620786, 7.430606034079467, 7.9343450568197476, 8.9987910516277, 10.372009570631342, 12.284394914328466, 14.633005289740272, 17.577813700603574, 19.927697861826505, 22.52607600298533, 25.445491305951396, 28.765811972598733]]

# # TOROIDAL
# # PHI=0
# # TH=14.5, 30., 50
# wData_toroidal_day = wData()
# wData_toroidal_day.L = [19.19336262878394, 18.44170762158429, 17.634689818650056, 16.774619280329436, 15.870973568121144, 14.945173033457994, 14.028904768370195, 13.155158873993123, 12.344938112441067, 11.604749975764234, 10.930738904575481, 10.316211756260143, 9.75388671248544, 9.238445540241065, 8.766606812216457, 8.335885915726054, 7.943934100935128, 7.588164336649544, 7.2651598055376585, 6.971815904052544, 6.704223892442735, 6.459211561792972, 6.233782238737572, 6.025535743815648, 5.832214930881749, 5.651921266259819, 5.483164870765788, 5.32477802354239, 5.1753917726100696, 5.034291310601722, 4.90086400545863, 4.774111330918037, 4.653541769448298, 4.538740904700333, 4.429129146909131, 4.3245506124914295, 4.224256029172474, 4.128576752344565, 4.036678461309496, 3.9484409581504445, 3.8638078368366093, 3.782269953348121, 3.7039985151184927, 3.6286372097524437, 3.5559922665832673, 3.4859882386491208, 3.4183656913794347, 3.353103040468634, 3.290203945046568, 3.2295761331790898]
# wData_toroidal_day.th = [75.62861565331889, 75.27986862301968, 74.97214410492452, 74.67925042127948, 74.31561288493302, 74.02297955170876, 73.71445642892299, 73.42205149985959, 73.11320887605595, 72.76612091185962, 72.45709641037331, 72.14782349646342, 71.85625974709927, 71.5468447018366, 71.18272085903013, 70.8730188357892, 70.58231017356529, 70.27261064849246, 69.96278983080701, 69.65286577708889, 69.34285658011552, 68.97902216688026, 68.66900619790142, 68.3589626816401, 68.04890977314076, 67.73886563074794, 67.4288484097261, 67.11887625588233, 66.80896729919718, 66.49913964746965, 66.1894113799813, 65.85626987841381, 65.54651656849668, 65.23691831541119, 64.92749306737964, 64.59358191100713, 64.28428495429985, 63.97521631667995, 63.64086268756404, 63.38347014898159, 63.04869099239295, 62.7400206160962, 62.40502328213168, 62.096746325290766, 61.761615448451096, 61.45380926895663, 61.16903168760962, 60.86158935974518, 60.52628863270445, 60.19088579329347]
# wData_toroidal_day.w = [[0.036107295141531166, 0.037136643128198504, 0.03947126576249463, 0.041940870784317054, 0.045225105501663705, 0.04513519470653354, 0.04467552708320439, 0.0477675683414311, 0.04549352895175724, 0.044006620107344456, 0.04283945925448116, 0.042813554784124914, 0.04362168522496123, 0.04628416919283028, 0.050387716344504126, 0.052635574315198524, 0.05749735708832328, 0.05757150712819256, 0.05975212543924382, 0.06074881021017157, 0.06846618756889583, 0.07663918786230173, 0.08604396087602516, 0.09500431664050872, 0.10443647693802292, 0.11688992207106452, 0.1280608141350779, 0.14004735761828663, 0.15596270356850558, 0.17319536707915384, 0.19036072191863, 0.21325643230618951, 0.23988204775051142, 0.26925520005583004, 0.30533386639249194, 0.34837846919654375, 0.3888223732171444, 0.4305098192876195, 0.47891606863379016, 0.5289767864747942, 0.5766107954349851, 0.6207894605612161, 0.7040191247904497, 0.8276853564753877, 0.9981582054854455, 1.2208492489917122, 1.4676814121424027, 1.704497431794539, 1.9538220145812213, 2.2393918947788203], [0.13420743541701538, 0.133141219533854, 0.1364147168886768, 0.1420845719291667, 0.15125580509211098, 0.14829865404577192, 0.14539545623382383, 0.15537694829480117, 0.14854210363187287, 0.14437046249440622, 0.14017117638117654, 0.1397844115556371, 0.14217126307300176, 0.15018515560610152, 0.16265105216312967, 0.1705910538286208, 0.18637896531221385, 0.18920314414815084, 0.19824204063109188, 0.20481946680792512, 0.23474406364841158, 0.2679151495455797, 0.3098778442383137, 0.35165271986845975, 0.39613362743375075, 0.44925855380326585, 0.5060549013510951, 0.5662608979293583, 0.6416128223279145, 0.7263523397760963, 0.8136354965081529, 0.921447298151973, 1.0571862149487798, 1.2161120263703251, 1.4280522505977962, 1.6862998638323454, 1.9243716779601299, 2.178240980149554, 2.475468806312168, 2.754405452084029, 2.9626769254290055, 3.1610427229979163, 3.635338276295842, 4.295615403484044, 5.244721312279623, 6.387039569136746, 7.642713654321649, 8.833558513026384, 10.127743626277192, 11.663198957706651], [0.2254783199524561, 0.22360605095589606, 0.22957872141845675, 0.23915996592559804, 0.2554455103963613, 0.25072619668801155, 0.24639745175170488, 0.2638513635030735, 0.2522260148717265, 0.2455899872834681, 0.23793409832449228, 0.23691255022917188, 0.24147545870312329, 0.2545339381369114, 0.2755962031563563, 0.28870526574874134, 0.3152013095850658, 0.32076992441754665, 0.3364857923262475, 0.34744810226753875, 0.39925705062914085, 0.456161916132841, 0.5297713724203866, 0.6017719677340222, 0.6792935867169482, 0.7713712951510641, 0.8705365422473629, 0.9736069407425366, 1.1064565704033074, 1.2536403972969192, 1.4039317631127675, 1.5945881162097963, 1.8310038415059278, 2.1115023535843283, 2.483781922271563, 2.9575798936904363, 3.355580905839279, 3.8044545747355065, 4.329600256281297, 4.819405141692989, 5.161996979711762, 5.521153635513762, 6.3568548696002924, 7.508318604459615, 9.166013305386349, 11.169462248642628, 13.36988081773253, 15.446794726407633, 17.70648827849961, 20.39467278977641], [0.31469762540359286, 0.3119864925588337, 0.32063533897191876, 0.33430278909471917, 0.35714783501868935, 0.3515688095814481, 0.3466598258875322, 0.371089298295845, 0.35496660340336683, 0.34597473858249156, 0.33516299243148634, 0.33339971110499783, 0.3398618334714679, 0.3583134914180962, 0.38757593441126625, 0.40611010458286767, 0.444144535405148, 0.4512988588356846, 0.47322676709381445, 0.4891682829575476, 0.5624816235281545, 0.6433009429596619, 0.747286396027485, 0.8499293237326262, 0.9601290778760044, 1.0910017821570102, 1.2311038374075551, 1.3810600003047357, 1.5664828508769904, 1.7758269241572395, 1.9916905035893346, 2.2609776957058396, 2.5968852770052733, 2.996325367631401, 3.525332761783709, 4.175273608814219, 4.770188506367142, 5.4100969884480605, 6.15784594707128, 6.8530110986036705, 7.342415281853057, 7.851211777470649, 9.036908543318722, 10.67970193508119, 13.039553774903707, 15.890254346353075, 19.016806878317656, 21.974526010757938, 25.184796980447263, 29.007600479410314]]


# # TOROIDAL
# # PHI=180
# # TH=16.5, 30., 50
# wData_toroidal_night = wData()
# wData_toroidal_night.L = [16.448738614252463, 14.862808415639353, 13.587029145475476, 12.563425209710925, 11.720225125824163, 11.003512802737133, 10.378547152660627, 9.823285499261436, 9.324384430084379, 8.873201564260782, 8.46390300038936, 8.092511229525726, 7.7552702080585165, 7.448758554282721, 7.169416921898182, 6.913537517074743, 6.678608313114342, 6.462403036023055, 6.262116575088649, 6.075297605879073, 5.901172341153917, 5.738029017005752, 5.584116850496593, 5.439083102876808, 5.302034420861487, 5.171314533075706, 5.048072602488993, 4.930110850680743, 4.817325606599579, 4.710066453883639, 4.6070626216712105, 4.5082051861023364, 4.413318366037058, 4.322301007565299, 4.234578727571375, 4.150463227159109, 4.069345279034454, 3.9911810282170865, 3.9154753223587044, 3.84251662325617, 3.7721915380849893, 3.7036806017798023, 3.638188147965962, 3.5743497310699746, 3.512547223881837, 3.4526119098444874, 3.3946416600283453, 3.3385392015071504, 3.283879565392129, 3.2312234525021633]
# wData_toroidal_night.th = [73.60396354586685, 73.35041025676429, 73.05811868918104, 72.82109676227218, 72.51200262385146, 72.27506738869351, 71.96571443287014, 71.72890901304436, 71.41935338683152, 71.18272085903013, 70.8730188357892, 70.63660218281728, 70.32681010089647, 70.09065216484363, 69.78082636612527, 69.52484288599034, 69.23516657035916, 68.97902216688026, 68.66900619790142, 68.43367072180959, 68.12379188836927, 67.86721936418508, 67.6104686031545, 67.30040999277375, 67.06586129206198, 66.80896729919718, 66.49913964746965, 66.2420753181978, 65.93232766258, 65.67514328433748, 65.41786855558055, 65.10828219739292, 64.85096062720682, 64.59358191100713, 64.33615642009569, 64.02693266655993, 63.769556489515985, 63.512166807859984, 63.2034000091153, 62.94613274808687, 62.68888519646741, 62.40502328213168, 62.14761988139697, 61.839521977543065, 61.58236194098292, 61.29765398908553, 61.04043223212092, 60.78330701464287, 60.52628863270445, 60.19088579329347]
# wData_toroidal_night.w = [[0.037073441052473725, 0.03986325121349955, 0.041080711343499304, 0.04272787774798532, 0.042899305540780815, 0.04109749984350038, 0.04143507951522869, 0.042474666161934196, 0.04469804344618618, 0.04883074608276626, 0.050396834713978524, 0.05526816772260809, 0.056444360011868956, 0.05809957979541781, 0.059431986893285854, 0.06095092325350973, 0.06915076350455941, 0.0769159688179457, 0.08453124220252804, 0.092491796227034, 0.10032294878254425, 0.11011142117623758, 0.12020185143885861, 0.1310954498343307, 0.14228052593104973, 0.15576487957871418, 0.1706229568701882, 0.1856301197443708, 0.20435401583404833, 0.22572242628703829, 0.25078041619044344, 0.277582324838416, 0.3115193141581197, 0.3487644637843098, 0.38409146274558675, 0.42041091383888013, 0.4622058405907214, 0.5083407622256935, 0.5462932549845784, 0.5851746974442434, 0.6289421726789414, 0.7048255383934273, 0.8055293251086926, 0.948307512572328, 1.1270306264664436, 1.3568615336208887, 1.5498887791433813, 1.7532655252756224, 1.9791466370443342, 2.2179331639732776], [0.11104201853575923, 0.11983965365283673, 0.12556747767731335, 0.13276048391954728, 0.13550148216966174, 0.130668472790851, 0.13196328616771427, 0.13586739048248828, 0.14290016539387737, 0.15622198928534786, 0.16158420132709006, 0.17716777168320735, 0.18252512478183044, 0.19085172475298853, 0.19735895972554157, 0.20446152224380357, 0.2363740262097692, 0.26516252978743066, 0.3025323747319284, 0.3395394124188831, 0.37577830699623405, 0.42084005200619123, 0.4682154189041559, 0.519754055600363, 0.5738196117869833, 0.6413128687598146, 0.7146058938823044, 0.7883762533758091, 0.880326686477071, 0.9861676714443197, 1.1144160059002821, 1.2662037036813842, 1.4609691435912349, 1.6892520041625068, 1.8952332194949786, 2.1125836179024513, 2.36075365744291, 2.6392112420498086, 2.825572933846641, 2.9995442282657714, 3.2066415464274955, 3.634616435392174, 4.187169166018309, 4.956903370221933, 5.904093614982511, 7.086768428237755, 8.040922328526989, 9.091079527194664, 10.19995611037303, 11.608417195464845], [0.18689000208726037, 0.20210897088050625, 0.21289117907012367, 0.22521001992820525, 0.23006771408476717, 0.22139274589972946, 0.22375136392449593, 0.23031659249788206, 0.2425095798541836, 0.2642595622537184, 0.2732201377351144, 0.2995891398778435, 0.3091868635843202, 0.3233619581988815, 0.3347169587225133, 0.3474789453895779, 0.40159480141862325, 0.4510731135084565, 0.5163819907377035, 0.5805270669315638, 0.6442589901968289, 0.7217710258914152, 0.8042767287343447, 0.8927677602471278, 0.9886495677748118, 1.1058663034250864, 1.2350868559489456, 1.3634809291810541, 1.5226736850439802, 1.7071260384266322, 1.9322949259963924, 2.1961226061518087, 2.5391675501846382, 2.9405332478574344, 3.3062492756715516, 3.6891708366781786, 4.126511449512752, 4.618543937605629, 4.941563270891846, 5.244691683766429, 5.600306730047227, 6.3540321896160075, 7.321021141072051, 8.66372224933449, 10.325979218274513, 12.396701942669175, 14.072685251495361, 15.894945411127576, 17.95775023801582, 20.300341033500988], [0.2622462115974547, 0.2838794334536841, 0.29939575414323244, 0.31716003926035913, 0.32417778147650705, 0.3116500767006194, 0.314678587370108, 0.32416843162145526, 0.3410446822498752, 0.3720184598935795, 0.3844115491126307, 0.4215715589600571, 0.43504262919303366, 0.45489317329851825, 0.4709851805613288, 0.4890473098608894, 0.5660607743127931, 0.6362630093398949, 0.7286662624961188, 0.8199770787664556, 0.9096993849122065, 1.0202846467742748, 1.1374316372252746, 1.2634222659996546, 1.3993243165907234, 1.5657026764376347, 1.7492855418017599, 1.931099977686713, 2.156901447144929, 2.420351280555885, 2.7417417828800335, 3.1172412196600736, 3.607301273585599, 4.187239514413131, 4.698099632402941, 5.243499183202425, 5.868491536167638, 6.567863974429771, 7.028776221297913, 7.460243401704698, 7.964811227750512, 9.033745775420458, 10.408636029487415, 12.333369304516035, 14.687451934093692, 17.63908796192849, 20.00120611664049, 22.609507650585392, 25.543570771130458, 28.870541232627822]]
